# video_info 表字段填写说明

## 字段分类和填写时机

### 📝 用户上传时填写（必填/选填）

| 字段 | 类型 | 必填 | 填写时机 | 说明 |
|------|------|------|----------|------|
| **id** | bigint | ✅ | 上传时自动生成 | 使用雪花算法生成唯一ID |
| **user_id** | bigint | ✅ | 上传时自动获取 | 从登录用户信息中获取 |
| **title** | varchar(128) | ✅ | 用户填写 | 视频标题，用户在上传表单中输入 |
| **description** | varchar(512) | ❌ | 用户填写 | 视频简介，用户在上传表单中输入（选填） |
| **video_url** | varchar(512) | ✅ | 上传时自动生成 | 视频上传到腾讯云COS后返回的URL |
| **cover_url** | varchar(512) | ❌ | 用户上传或自动截取 | **需要添加上传功能**：用户上传封面图片，或从视频中自动截取第一帧 |
| **category_id** | int | ❌ | 用户选择 | **需要添加分类选择**：用户从分类列表中选择视频分类 |
| **tags** | varchar(255) | ❌ | 用户填写 | **需要添加标签输入**：用户输入标签，多个标签用逗号分隔 |

### 🔄 系统自动生成/更新

| 字段 | 类型 | 填写时机 | 说明 |
|------|------|----------|------|
| **duration** | int | 上传时/后续处理 | 视频时长（秒）。当前为0，后续可以使用FFmpeg获取 |
| **status** | tinyint | 上传时默认 | 默认为0（待审核），管理员审核后更新为1（已发布）或2（驳回） |
| **audit_msg** | varchar(255) | 管理员审核时 | 审核意见，管理员审核时填写 |
| **is_hot** | tinyint | 管理员设置 | 是否热门，管理员在后台设置 |
| **view_count** | bigint | 用户观看时 | 播放量，用户观看视频时自动累加 |
| **like_count** | bigint | 用户点赞时 | 点赞数，用户点赞时自动累加 |
| **comment_count** | bigint | 用户评论时 | 评论数，用户评论时自动累加 |
| **share_count** | bigint | 用户分享时 | 转发数，用户分享时自动累加 |
| **create_time** | datetime | 上传时自动 | 创建时间，上传时自动设置为当前时间 |
| **update_time** | datetime | 更新时自动 | 更新时间，每次更新时自动更新 |
| **is_deleted** | tinyint | 删除时 | 逻辑删除标记，删除时设置为1 |

## 字段填写流程图

```
用户上传视频
    ↓
1. 填写标题（必填）✅
2. 填写简介（选填）✅
3. 选择分类（选填）❌ 需要添加
4. 输入标签（选填）❌ 需要添加
5. 上传视频文件（必填）✅
6. 上传封面图片（选填）❌ 需要添加
    ↓
后端处理
    ↓
1. 生成视频ID（雪花算法）✅
2. 获取用户ID（从登录信息）✅
3. 上传视频到COS，获取video_url ✅
4. 上传封面到COS，获取cover_url ❌ 需要添加
5. 获取视频时长（可选，使用FFmpeg）❌ 后续优化
    ↓
保存到数据库
    ↓
状态：待审核（PENDING）
    ↓
管理员审核
    ↓
状态：已发布（PASSED）或 驳回（REJECTED）
```

## 需要完善的功能

### 1. 封面上传功能 ⚠️ 重要
- **当前状态**：封面URL为空字符串
- **解决方案**：
  - 方案A：用户手动上传封面图片（推荐）
  - 方案B：从视频中自动截取第一帧作为封面（需要FFmpeg）

### 2. 分类选择功能
- **当前状态**：category_id 为 null
- **解决方案**：添加分类下拉选择框，从数据库或配置中获取分类列表

### 3. 标签输入功能
- **当前状态**：tags 为 null
- **解决方案**：添加标签输入框，支持多个标签（逗号分隔）

### 4. 视频时长获取（后续优化）
- **当前状态**：duration 为 0
- **解决方案**：使用FFmpeg或Java库获取视频时长

## 字段默认值策略

### 可以为空的字段（NULL）
- `description` - 视频简介
- `cover_url` - 封面地址（建议提供默认封面）
- `category_id` - 分类ID
- `tags` - 标签
- `audit_msg` - 审核意见

### 有默认值的字段
- `duration` - 默认为 0（后续可以获取）
- `status` - 默认为 0（待审核）
- `is_hot` - 默认为 0（非热门）
- `view_count` - 默认为 0
- `like_count` - 默认为 0
- `comment_count` - 默认为 0
- `share_count` - 默认为 0
- `is_deleted` - 默认为 0（未删除）
- `create_time` - 数据库自动设置
- `update_time` - 数据库自动更新
