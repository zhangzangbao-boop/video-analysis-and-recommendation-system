# 如何运行 import_all_videos.bat

## 🚀 快速开始

### 方法一：直接双击运行（最简单）

1. **打开文件资源管理器**，导航到项目目录
2. **找到文件**: `backend-server\scripts\import_all_videos.bat`
3. **双击运行**即可

### 方法二：从命令行运行

1. **打开命令提示符（CMD）或PowerShell**
2. **切换到项目目录**:
   ```cmd
   cd D:\Users\xjz20\Documents\GitHub\veido-analysis\video-analysis-and-recommendation-system
   ```
3. **运行批处理脚本**:
   ```cmd
   backend-server\scripts\import_all_videos.bat
   ```

## ⚙️ 运行前配置

在运行脚本之前，需要先编辑脚本文件，修改以下配置：

### 1. 修改JSON文件路径

打开 `import_all_videos.bat`，找到这一行：

```bat
set JSON_PATH=F:\视频json文件\视频json文件
```

**修改为您的实际路径**：

- **方式1：导入单个文件**
  ```bat
  set JSON_PATH=F:\视频json文件\视频json文件\videos_pexels_food.json
  ```

- **方式2：导入目录下所有JSON文件**（推荐）
  ```bat
  set JSON_PATH=F:\视频json文件\视频json文件
  ```

### 2. 修改用户ID（可选）

```bat
set USER_ID=10000
```

如果不确定admin用户ID，可以查询：
```sql
SELECT id FROM sys_user WHERE username = 'admin';
```

### 3. 修改视频状态（可选）

```bat
set STATUS=1
```

- `1` = 已发布（用户可见）
- `0` = 待审核（需要管理员审核）

### 4. 是否使用外部URL（可选）

```bat
set USE_EXTERNAL_URL=0
```

- `0` = 提示需要上传到COS（推荐）
- `1` = 直接使用Pexels URL（快速测试）

## 📋 运行步骤详解

### 步骤1: 编辑脚本配置

1. 用记事本或任何文本编辑器打开 `import_all_videos.bat`
2. 修改 `JSON_PATH` 为您的JSON文件路径
3. 保存文件

### 步骤2: 运行脚本

双击 `import_all_videos.bat` 或在命令行运行

### 步骤3: 查看输出

脚本会：
- ✅ 检查Python是否安装
- ✅ 检查JSON文件是否存在
- ✅ 生成SQL脚本文件
- ✅ 显示下一步操作说明

### 步骤4: 执行SQL导入

脚本运行成功后，会生成 `imported_videos.sql` 文件，然后执行：

```cmd
mysql -u root -p short_video_platform < backend-server\scripts\imported_videos.sql
```

或者使用MySQL客户端：
```sql
source backend-server\scripts\imported_videos.sql;
```

## 🔍 常见问题

### Q1: 双击后窗口一闪而过

**原因**: 脚本执行出错或路径不正确

**解决**: 
1. 在命令行中运行，查看错误信息
2. 检查JSON文件路径是否正确
3. 检查Python是否已安装

### Q2: 提示"未找到Python"

**解决**: 
1. 安装Python 3.x
2. 或将Python添加到系统PATH环境变量
3. 或使用完整路径：`C:\Python39\python.exe`

### Q3: 提示"JSON文件不存在"

**解决**: 
1. 检查 `JSON_PATH` 变量是否正确
2. 确保路径中的中文字符正确
3. 尝试使用绝对路径

### Q4: 生成的SQL文件在哪里？

**位置**: `backend-server\scripts\imported_videos.sql`

### Q5: 如何导入多个JSON文件？

**方法1**: 设置 `JSON_PATH` 为目录路径
```bat
set JSON_PATH=F:\视频json文件\视频json文件
```

**方法2**: 多次运行脚本，每次修改 `JSON_PATH` 指向不同的文件

## 📝 完整示例

### 示例1: 导入单个文件

```bat
REM 编辑脚本
set JSON_PATH=F:\视频json文件\视频json文件\videos_pexels_food.json
set USER_ID=10000
set STATUS=1
set USE_EXTERNAL_URL=0

REM 运行脚本
双击 import_all_videos.bat

REM 执行SQL
mysql -u root -p short_video_platform < backend-server\scripts\imported_videos.sql
```

### 示例2: 导入目录下所有文件

```bat
REM 编辑脚本
set JSON_PATH=F:\视频json文件\视频json文件
set USER_ID=10000
set STATUS=1
set USE_EXTERNAL_URL=1

REM 运行脚本
双击 import_all_videos.bat

REM 执行SQL
mysql -u root -p short_video_platform < backend-server\scripts\imported_videos.sql
```

## 🎯 推荐配置

**开发/测试环境**:
```bat
set JSON_PATH=F:\视频json文件\视频json文件
set USER_ID=10000
set STATUS=1
set USE_EXTERNAL_URL=1  # 快速测试，使用外部URL
```

**生产环境**:
```bat
set JSON_PATH=F:\视频json文件\视频json文件
set USER_ID=10000
set STATUS=0  # 先设为待审核
set USE_EXTERNAL_URL=0  # 提示上传到COS
```

## 📚 相关文档

- [快速使用指南](./快速使用指南.md)
- [视频导入完整流程](./视频导入完整流程.md)
- [README_视频导入](./README_视频导入.md)
